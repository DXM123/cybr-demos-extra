---
# Load policy into root branch
# This policy registers the seed generation service
- !policy
  id: conjur/seed-generation
  body:
  # This webservice represents the Seed service API
  - !webservice

  # Hosts that can generate seeds become members of the
  # `consumers` layer.
  - !layer consumers

  # Authorize `consumers` to request seeds
  - !permit
    role: !layer consumers
    privilege: [ "execute" ]
    resource: !webservice

  # Add host kubernetes/followers/conjur-follower to the consumers group
  - !grant
    roles:
      - !layer consumers
    members:
      - !host ../../kubernetes/followers/conjur-follower